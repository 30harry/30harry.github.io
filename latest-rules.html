<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Syntax Checker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        textarea {
            width: 100%;
            height: 200px;
        }
        #result {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ccc;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid black;
        }
        th, td {
            padding: 10px;
            text-align: left;
        }
    </style>
</head>
<body>
    <h1>Syntax Checker</h1>
    Only checks parenthesis '(' and ')' are matching for now, will add more checks later on (e.g. function names, arguments, etc.)
    <textarea id="inputText" placeholder="Enter your text here..."></textarea>
    <button onclick="checkSyntax()">Check Syntax</button>
    <div id="result"></div>

    
    <h1>General Syntax Notes</h1><ul>
        <li>A rule is comprised of Functions, Variables and Constants</li>
        <li>Some of the functions are contextual</li>
        <li>Functions can be called with and without parameters, for example:</li>

        <ul>
            <li>TYPE_STAT</li>
            <li>TYPE_STAT(RESERVES)</li>
            <li>ANY(ELF)</li>
            <li>ANY(ELF,WIZARD)</li>
            <li>ANY(ELF,WIZARD,IMP)</li>
        </ul>
        <li>Each rule can have multiple expressions.  Each expression is seperated by a comma:</li>
        <ul>
            <li>MOVE(RANDOM(HAND),RESERVES),MOVE(RANDOM(RESERVES),HAND) // move random card from hand to reserves, then move random card from reserves to hand</li>
            <li>$h(RANDOM(HAND)),$r(RANDOM(RESERVES)),IF(AND(GT(COUNT($h),0),GT(COUNT($r),0)), MOVE($r,HAND), MOVE($h,RESERVES)) // if there's at least one card in the hand and reserves, swap them</li>
        </ul>
        <li>Cards can be referenced using @NAME and @NUMBER</li>
        <li>Buffs can be referenced using &NAME</li>
        <li>Traits can be referenced using #NAME</li>
        <li>Add comments to rules using // (double-slash), comments run to end of line</li>
    </ul>

    <h1>How to use temps</h1>
    Temps allow you to reuse parts of the rule and also make things more readable
    <ul>
        <li>Declare a temp variable with an expression: <b>$[name]( ... )</b>, e.g. <b>$fred(COUNT(HAND))</b> </li>
        <li>Use a temp variable: <b>$[name]</b>, e.g. <b>$fred</b></li>
        <li>Example rule: <b>$types(ANY(ELF,HUMAN,KOBOLD))</b>, IF(EQ(TYPE_STAT(OPP_CARD),<b>$types</b>), ADDSUB(3))</li>
    </ul>

    <h1>Variables</h1>
    <ul><li>Variables either contain results of functions, constants or game specific variables</li>
    <li></li></ul>
    <table><tr><th>Name(s)</th><th>Type</th><th>Description</th></tr><tr bgcolor="lightgrey"><td>ARMOR, ARMOR_CLASH</td><td>Boolean</td><td>TRUE if the clash is armor, otherwise FALSE</td></tr><tr bgcolor="white"><td>ATTACKER, ATT, ATTACK</td><td>Boolean</td><td>TRUE if the player is the ATTACKER, otherwise FALSE</td></tr><tr bgcolor="lightgrey"><td>ATTACKER_CARD, ATTACK_CARD, ATT_CARD</td><td>Card</td><td>Returns attackers card</td></tr><tr bgcolor="white"><td>ATTACKER_CARDS, ATT_CARDS</td><td>List<Card></td><td>Returns attackers hand and reserves</td></tr><tr bgcolor="lightgrey"><td>ATTACKER_HAND, ATTACK_HAND, ATT_HAND</td><td>List<Card></td><td>Returns attackers hand</td></tr><tr bgcolor="white"><td>ATTACKER_RESERVES, ATTACK_RESERVES, ATT_RESERVES</td><td>List<Card></td><td>Returns attackers reserves</td></tr><tr bgcolor="lightgrey"><td>ATTACKER_STAT</td><td>PlayerStat</td><td>Returns attackers current stat</td></tr><tr bgcolor="white"><td>ATTACKER_TREASURE, ATTACK_TREASURE, ATT_TREASURE</td><td>List<Card></td><td>Returns attackers treasure</td></tr><tr bgcolor="lightgrey"><td>CLASH_ROUND, ROUND, CLASH</td><td>Numeric</td><td>Returns the current clash round</td></tr><tr bgcolor="white"><td>CLASH_ROUNDS_LEFT, ROUNDS_LEFT, CLASHE_LEFT</td><td>Numeric</td><td>Returns the number of remaining clashes including this one</td></tr><tr bgcolor="lightgrey"><td>DECK</td><td>List<Card></td><td>Returns the deck</td></tr><tr bgcolor="white"><td>DEFENDER, DEF, DEFEND</td><td>Boolean</td><td>TRUE if the player is the DEFENDER, otherwise FALSE</td></tr><tr bgcolor="lightgrey"><td>DEFENDER_CARD, DEFEND_CARD, DEF_CARD</td><td>Card</td><td>Returns defenders card</td></tr><tr bgcolor="white"><td>DEFENDER_CARDS, DEF_CARDS</td><td>List<Card></td><td>Returns defenders hand and reserves</td></tr><tr bgcolor="lightgrey"><td>DEFENDER_RESERVES, DEFEND_RESERVES, DEF_RESERVES</td><td>List<Card></td><td>Returns defenders reserves</td></tr><tr bgcolor="white"><td>DEFENDER_STAT</td><td>PlayerStat</td><td>Returns defenders current stat</td></tr><tr bgcolor="lightgrey"><td>DEFENEDER_HAND, DEFEND_HAND, DEF_HAND</td><td>List<Card></td><td>Returns defenders hand</td></tr><tr bgcolor="white"><td>DEFENEDER_TREASURE, DEFEND_TREASURE, DEF_TREASURE</td><td>List<Card></td><td>Returns defenders treasure</td></tr><tr bgcolor="lightgrey"><td>EXILED, BANISHED, REMOVED, REMOVEDDECK, EXILEDDECK, REMOVED_FROM_GAME, OUT_OF_GAME</td><td>List<Card></td><td>Returns the exiled deck</td></tr><tr bgcolor="white"><td>FIRST_CLASH_ROUND, FIRST_CLASH, FIRST_ROUND</td><td>Boolean</td><td>Returns TRUE if this is the fist clash round</td></tr><tr bgcolor="lightgrey"><td>HEALTH, HEALTH_CLASH</td><td>Boolean</td><td>TRUE if the clash is health, otherwise FALSE</td></tr><tr bgcolor="white"><td>HIGH, HIGH_CLASH</td><td>Boolean</td><td>TRUE if the clash is high, otherwise FALSE</td></tr><tr bgcolor="lightgrey"><td>LAST_CLASH_ROUND, LAST_CLASH, LAST_ROUND, FINAL_CLASH_ROUND, FINAL_CLASH, FINAL_ROUND</td><td>Boolean</td><td>Returns TRUE if this is the last clash round</td></tr><tr bgcolor="white"><td>LOSS, LOSER, LOSS_RESULT</td><td>Boolean</td><td>Returns TRUE if the player is not the clash winner</td></tr><tr bgcolor="lightgrey"><td>LOW, LOW_CLASH</td><td>Boolean</td><td>TRUE if the clash is low, otherwise FALSE</td></tr><tr bgcolor="white"><td>OPPONENT_CARD, OPP_CARD</td><td>Card</td><td>Returns opponents card</td></tr><tr bgcolor="lightgrey"><td>OPPONENT_CARDS, OPP_CARDS</td><td>List<Card></td><td>Returns opponents hand and reserves</td></tr><tr bgcolor="white"><td>OPPONENT_HAND, OPP_HAND</td><td>List<Card></td><td>Returns opponents hand</td></tr><tr bgcolor="lightgrey"><td>OPPONENT_RESERVES, OPP_RESERVES</td><td>List<Card></td><td>Returns opponents reserves</td></tr><tr bgcolor="white"><td>OPPONENT_STAT</td><td>PlayerStat</td><td>Returns opponents current stat</td></tr><tr bgcolor="lightgrey"><td>OPPONENT_TREASURE, OPP_TREASURE</td><td>List<Card></td><td>Returns opponents treasure</td></tr><tr bgcolor="white"><td>OPPONENT_VPS, OPP_VPS</td><td>Numeric</td><td>Returns opponents VPS</td></tr><tr bgcolor="lightgrey"><td>PHASE_BC, BC_PHASE, IS_BC</td><td>Boolean</td><td>Returns TRUE if current phase is BC otherwise FALSE</td></tr><tr bgcolor="white"><td>PHASE_CA, CA_PHASE, IS_CA</td><td>Boolean</td><td>Returns TRUE if current phase is CA otherwise FALSE</td></tr><tr bgcolor="lightgrey"><td>PHASE_CC, CC_PHASE, IS_CC</td><td>Boolean</td><td>Returns TRUE if current phase is CC otherwise FALSE</td></tr><tr bgcolor="white"><td>PHASE_CH, CH_PHASE, IS_CH</td><td>Boolean</td><td>Returns TRUE if current phase is CH otherwise FALSE</td></tr><tr bgcolor="lightgrey"><td>PHASE_CMA, CMA_PHASE, IS_CMA</td><td>Boolean</td><td>Returns TRUE if current phase is CMA otherwise FALSE</td></tr><tr bgcolor="white"><td>PHASE_CT, CT_PHASE, IS_CT</td><td>Boolean</td><td>Returns TRUE if current phase is CT otherwise FALSE</td></tr><tr bgcolor="lightgrey"><td>PHASE_GB, GB_PHASE, IS_GB</td><td>Boolean</td><td>Returns TRUE if current phase is GB otherwise FALSE</td></tr><tr bgcolor="white"><td>PHASE_GE, GE_PHASE, IS_GE</td><td>Boolean</td><td>Returns TRUE if current phase is GE otherwise FALSE</td></tr><tr bgcolor="lightgrey"><td>PHASE_MR, MR_PHASE, IS_MR</td><td>Boolean</td><td>Returns TRUE if current phase is MR otherwise FALSE</td></tr><tr bgcolor="white"><td>PHASE_MS, MS_PHASE, IS_MS</td><td>Boolean</td><td>Returns TRUE if current phase is MS otherwise FALSE</td></tr><tr bgcolor="lightgrey"><td>PHASE_RC, RC_PHASE, IS_RC</td><td>Boolean</td><td>Returns TRUE if current phase is RC otherwise FALSE</td></tr><tr bgcolor="white"><td>PLAYER_CARD, YOUR_CARD</td><td>Card</td><td>Returns players card</td></tr><tr bgcolor="lightgrey"><td>PLAYER_CARDS, YOUR_CARDS</td><td>List<Card></td><td>Returns players hand and reserves</td></tr><tr bgcolor="white"><td>PLAYER_HAND, YOUR_HAND</td><td>List<Card></td><td>Returns players hand</td></tr><tr bgcolor="lightgrey"><td>PLAYER_RESERVES, YOUR_RESERVES</td><td>List<Card></td><td>Returns players reserves</td></tr><tr bgcolor="white"><td>PLAYER_STAT</td><td>PlayerStat</td><td>Returns players current stat</td></tr><tr bgcolor="lightgrey"><td>PLAYER_TREASURE, YOUR_TREASURE</td><td>List<Card></td><td>Returns players treasure</td></tr><tr bgcolor="white"><td>PLAYER_VPS, YOUR_VPS</td><td>Numeric</td><td>Returns players VPS</td></tr><tr bgcolor="lightgrey"><td>POWER, POWER_CLASH</td><td>Boolean</td><td>TRUE if the clash is power, otherwise FALSE</td></tr><tr bgcolor="white"><td>SIDEDECK</td><td>List<Card></td><td>Returns the side deck</td></tr><tr bgcolor="lightgrey"><td>SOURCE_HAND, IS_HAND</td><td>Boolean</td><td>Returns TRUE if a hand card otherwise FALSE</td></tr><tr bgcolor="white"><td>SOURCE_PLAYED, IS_PLAYED</td><td>Boolean</td><td>Returns TRUE if a played card otherwise FALSE</td></tr><tr bgcolor="lightgrey"><td>SOURCE_RESERVES, IS_RESERVES</td><td>Boolean</td><td>Returns TRUE if a reserve card otherwise FALSE</td></tr><tr bgcolor="white"><td>SOURCE_TREASURE, IS_TREASURE</td><td>Boolean</td><td>Returns TRUE if a treasure card otherwise FALSE</td></tr><tr bgcolor="lightgrey"><td>SPEED, SPEED_CLASH</td><td>Boolean</td><td>TRUE if the clash is speed, otherwise FALSE</td></tr><tr bgcolor="white"><td>STAT_NAME</td><td>String</td><td>Returns the active stat</td></tr><tr bgcolor="lightgrey"><td>TEST_NAME</td><td>String</td><td>Returns the active test</td></tr><tr bgcolor="white"><td>TIE, TIE_RESULT, DRAW, DRAW_RESULT</td><td>Boolean</td><td>Returns TRUE if the clash is tied</td></tr><tr bgcolor="lightgrey"><td>TYPE, TYPE_CLASH</td><td>Boolean</td><td>TRUE if the clash is type, otherwise FALSE</td></tr><tr bgcolor="white"><td>WIN, WINNER, WIN_RESULT</td><td>Boolean</td><td>Returns TRUE if the player is the clash winner</td></tr></table>

    <h1>Functions</h1>
    <ul>
        <li>To call a function, use the function name followed by the arguments in parentheses, e.g. <b>ADD(3, 4), WINS()</b></li>
        <li>You can also call some functions without parameters by ommitting the parentheses, e.g. <b>WINS</b></li>
        <li>Some functions can take a variable number of arguments, e.g. <b>ANY(ELF, HUMAN, KOBOLD)</b></li>
        <li>Some functions are contextual, but have a default parameter based on the player of the card, e.g. <b>ADD(2)</b> is the same as <b>ADD(PLAYER_STAT,2)</b> but not the same as <b>ADD(OPPONENT_STAT,2)</b></li>
    </ul>
    <table><tr><th>Name(s)</th><th>Return Type</th><th>Parameter Type(s)</th><th>Description</th></tr><tr bgcolor="lightgrey"><td>ABS</td><td>SameAsFirstParam</td><td>AnyNumeric</td><td>ABS(A) - Converts negative numbers to positive and positive to positive</td></tr><tr bgcolor="white"><td>ACTIVE_STAT</td><td>CardStat</td><td></td><td>ACTIVE_STAT or ACTIVE_STAT() - Returns active stat from card</td></tr><tr bgcolor="white"><td></td><td>CardStat</td><td>Card</td><td>ACTIVE_STAT(CARD) - Returns active stat from specified card</td></tr><tr bgcolor="white"><td></td><td>List<CardStat></td><td>List<Card></td><td>ACTIVE_STAT(LIST) - Returns active stats from specified card(s)</td></tr><tr bgcolor="lightgrey"><td>ADD, SUM</td><td>PlayerStat</td><td>AnyNumeric</td><td>ADD(A) - modifies player stat and returns A+stat</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyStat, AnyNumeric</td><td>ADD(A,B) - modifies stat A and returns A+B</td></tr><tr bgcolor="lightgrey"><td></td><td>Numeric</td><td>Numeric, AnyNumeric</td><td>ADD(A,B) - returns A+B</td></tr><tr bgcolor="lightgrey"><td></td><td>Numeric</td><td>List<AnyNumeric></td><td>ADD(LIST) - returns sum of the list of numerics</td></tr><tr bgcolor="white"><td>ADD_BUFF, ADDBUFF</td><td>Void</td><td>String</td><td>ADDBUFF(BUFF) - Adds buff to player</td></tr><tr bgcolor="white"><td></td><td>Void</td><td>String, List<Any></td><td>ADDBUFF(BUFF,LIST_OF_PROPERTIES) - Adds buff to player, with initial properties</td></tr><tr bgcolor="white"><td></td><td>Void</td><td>Boolean, String</td><td>ADDBUFF(PLAYER|OPPONENT|ATTACKER|DEFENDER,BUFF) - Adds buff to player if TRUE otherwise to the opponent</td></tr><tr bgcolor="white"><td></td><td>Void</td><td>Boolean, String, List<Any></td><td>ADDBUFF(PLAYER|OPPONENT|ATTACKER|DEFENDER,BUFF,LIST_OF_PROPERTIES) - Adds buff to player if TRUE otherwise to the opponent, with initial properties</td></tr><tr bgcolor="lightgrey"><td>ADD_NEW_BUFF, ADDNEWBUFF</td><td>Void</td><td>String</td><td>ADDNEWBUFF(BUFF) - Adds buff to player if they dont already have it</td></tr><tr bgcolor="lightgrey"><td></td><td>Void</td><td>String, List<Any></td><td>ADDNEWBUFF(BUFF,LIST_OF_PROPERTIES) - Adds buff to player, with initial properties if they dont already have it</td></tr><tr bgcolor="lightgrey"><td></td><td>Void</td><td>Boolean, String</td><td>ADDNEWBUFF(PLAYER|OPPONENT|ATTACKER|DEFENDER,BUFF) - Adds buff to player if TRUE otherwise to the opponent if they dont already have it</td></tr><tr bgcolor="lightgrey"><td></td><td>Void</td><td>Boolean, String, List<Any></td><td>ADDNEWBUFF(PLAYER|OPPONENT|ATTACKER|DEFENDER,BUFF,LIST_OF_PROPERTIES) - Adds buff to player if TRUE otherwise to the opponent, with initial properties if they dont already have it</td></tr><tr bgcolor="white"><td>ADDRULE, ADD_RULE</td><td>Boolean</td><td>Boolean, String, String</td><td>ADDRULE(PLAYER|OPPONENT|ATTACKER|DEFENDER,RULE,TIMING) - Adds a rule to the player that never expires</td></tr><tr bgcolor="white"><td></td><td>Boolean</td><td>Boolean, String, String, AnyNumeric</td><td>ADDRULE(PLAYER|OPPONENT|ATTACKER|DEFENDER,RULE,TIMING,EXPIRES) - Adds a rule to the player that expires after N invocations</td></tr><tr bgcolor="lightgrey"><td>ADDSUB</td><td>PlayerStat</td><td>AnyNumeric</td><td>ADDSUB(A) - modifies current stat and returns A+stat if test is high otherwise A-stat</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyStat, AnyNumeric</td><td>ADDSUB(A,B) - modifies stat and returns A+B if test is high otherwise A-B</td></tr><tr bgcolor="lightgrey"><td></td><td>Numeric</td><td>Numeric, AnyNumeric</td><td>ADDSUB(A,B) - returns A+B if test is high otherwise A-B</td></tr><tr bgcolor="white"><td>ADDTAG, ADDTAGS</td><td>Card</td><td>String</td><td>ADDTAG(TRAIT) - adds tag to card, returns card</td></tr><tr bgcolor="white"><td></td><td>Card</td><td>List<String></td><td>ADDTAGS(LIST_TRAIT) - adds tags to card, returns card</td></tr><tr bgcolor="white"><td></td><td>SameAsFirstParam</td><td>AnyCardOrStat, String</td><td>ADDTAG(CARD,TRAIT) - adds tag to card, returns card</td></tr><tr bgcolor="white"><td></td><td>SameAsFirstParam</td><td>AnyCardOrStat, List<String></td><td>ADDTAGS(CARD,LIST_TRAIT) - adds tags to card, returns card</td></tr><tr bgcolor="white"><td></td><td>SameAsFirstParam</td><td>List<AnyCardOrStat>, String</td><td>ADDTAG(CARD_LIST,TRAIT) - adds tag to cards, returns cards</td></tr><tr bgcolor="white"><td></td><td>SameAsFirstParam</td><td>List<AnyCardOrStat>, List<String></td><td>ADDTAGS(CARD_LIST,LIST_TRAIT) - adds tags to cards, returns cards</td></tr><tr bgcolor="lightgrey"><td>ADDTRAITS, ADDTRAIT</td><td>Card</td><td>String</td><td>ADDTRAIT(TRAIT) - adds trait to card, returns card</td></tr><tr bgcolor="lightgrey"><td></td><td>Card</td><td>List<String></td><td>ADDTRAITS(LIST_TRAIT) - adds traits to card, returns card</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyCardOrStat, String</td><td>ADDTRAIT(CARD,TRAIT) - adds trait to card, returns card</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyCardOrStat, List<String></td><td>ADDTRAITS(CARD,LIST_TRAIT) - adds traits to card, returns card</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>List<AnyCardOrStat>, String</td><td>ADDTRAIT(CARD_LIST,TRAIT) - adds trait to cards, returns cards</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>List<AnyCardOrStat>, List<String></td><td>ADDTRAITS(CARD_LIST,LIST_TRAIT) - adds traits to cards, returns cards</td></tr><tr bgcolor="white"><td>ALLTAGS, ALL_TAGS, WITHALLTAGS, WITH_ALL_TAGS</td><td>SameAsFirstParam</td><td>List<AnyCardOrStat>, List<String></td><td>ALLTAGS(LIST_A,LIST_T) - returns all stats in LIST_A that have all of tags in LIST_T</td></tr><tr bgcolor="lightgrey"><td>ALLTRAITS, ALL_TRAITS, WITHALLTRAITS, WITH_ALL_TRAITS</td><td>SameAsFirstParam</td><td>List<AnyCardOrStat>, List<String></td><td>ALLTRAITS(LIST_A,LIST_T) - returns all stats in LIST_A that have all of traits in LIST_T</td></tr><tr bgcolor="white"><td>AND</td><td>Boolean</td><td>Boolean, OneOrMoreOfTheSame<Boolean></td><td>AND(A,B,...) - returns TRUE if all parameters are TRUE</td></tr><tr bgcolor="lightgrey"><td>ANYTAGS, ANY_TAGS, ANY_TAG, ANYTAG, WITHTTAG, WITH_TAG, WITHANYTAGS, WITH_ANY_TAGS</td><td>SameAsFirstParam</td><td>List<AnyCardOrStat>, String</td><td>WITH_TAG(LIST,T) - returns all cards in the list with the tag T</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>List<Any>, List<String></td><td>ANY_TAGS(LIST_A,LIST_T) - returns all cards in LIST_A that have any of tag in LIST_T</td></tr><tr bgcolor="white"><td>ANYTRAITS, ANY_TRAITS, ANY_TRAIT, WITHTRAIT, WITH_TRAIT, WITHANYTRAITS, WITH_ANY_TRAITS</td><td>SameAsFirstParam</td><td>List<AnyCardOrStat>, String</td><td>WITH_TRAIT(LIST,T) - returns all cards in the list with the trait T</td></tr><tr bgcolor="white"><td></td><td>SameAsFirstParam</td><td>List<Any>, List<String></td><td>ANY_TRAITS(LIST_A,LIST_T) - returns all cards in LIST_A that have any of traits in LIST_T</td></tr><tr bgcolor="lightgrey"><td>ARMOR_STAT</td><td>CardStat</td><td></td><td>ARMOR_STAT or ARMOR_STAT() - Returns armor stat from card</td></tr><tr bgcolor="lightgrey"><td></td><td>CardStat</td><td>Card</td><td>ARMOR_STAT(CARD) - Returns armor stat from specified card</td></tr><tr bgcolor="lightgrey"><td></td><td>List<CardStat></td><td>List<Card></td><td>ARMOR_STAT(LIST) - Returns armor stats from specified card(s)</td></tr><tr bgcolor="white"><td>ATTACK_EFFECT, ATTACKER_EFFECT</td><td>Void</td><td>OneOrMoreOf<Any></td><td>ATTACKER_EFFECT(...) - Logs the effect of card rules on the ATTACKER</td></tr><tr bgcolor="lightgrey"><td>BEST</td><td>SameAsFirstParam</td><td>AnyStat, AnyStat</td><td>BEST(A,B) - Returns the better of stat A and stat B</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyStat, String</td><td>BEST(A,B) - Returns the better of stat A and stat B</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyStat, Numeric</td><td>BEST(A,B) - Returns the better of stat A and stat B</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyStat, List<AnyStat></td><td>BEST(A,LIST) - Returns the better of stat A and any stat in the list</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyStat, List<String></td><td>BEST(A,LIST) - Returns the better of stat A and any stat in the list</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyStat, List<Numeric></td><td>BEST(A,LIST) - Returns the better of stat A and any stat in the list</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyStat, List<Any></td><td>BEST(A,LIST) - Returns the better of stat A and any stat in the list</td></tr><tr bgcolor="white"><td>CALLSCLASH, CALLS_CLASH</td><td>Void</td><td></td><td>CALLSCLASH or CALLSCLASH() - Changes caller of clash to player</td></tr><tr bgcolor="white"><td></td><td>Void</td><td>Boolean</td><td>CALLSCLASH(PLAYER|OPPONENT|ATTACKER|DEFENDER) - If TRUE then changes caller of clash to player, otherwise caller to opponent</td></tr><tr bgcolor="lightgrey"><td>CARD</td><td>Card</td><td></td><td>CARD or CARD() - Returns players card</td></tr><tr bgcolor="lightgrey"><td></td><td>Card</td><td>Boolean</td><td>CARD(PLAYER|OPPONENT|ATTACKER|DEFENDER) - Returns players card if TRUE otherwise opponents card</td></tr><tr bgcolor="white"><td>CARDS_LOST, LOST_CARDS, LOST_CARDS_THIS_GAME</td><td>List<Card></td><td></td><td>CARDS_LOST or CARDS_LOST() - Returns list of all cards lost this game</td></tr><tr bgcolor="white"><td></td><td>Void</td><td>Boolean</td><td>CARDS_LOST(PLAYER|OPPONENT|ATTACKER|DEFENDER) - Returns list of cards lost this game by player</td></tr><tr bgcolor="lightgrey"><td>CARDS_WON, CARDSWON, WON_CARDS, WON_CARDS_THIS_GAME</td><td>List<Card></td><td></td><td>CARDS_WON or CARDS_WON() - Returns list of all cards won this game</td></tr><tr bgcolor="lightgrey"><td></td><td>Void</td><td>Boolean</td><td>CARDS_WON(PLAYER|OPPONENT|ATTACKER|DEFENDER) - Returns list of cards won this game by player</td></tr><tr bgcolor="white"><td>CHANGE_VERSION, CHANGEVERSION</td><td>Card</td><td>String</td><td>CHANGE_VERSION(VERSION) - Replaces the card with the data from the specified version (retains traits)</td></tr><tr bgcolor="white"><td></td><td>Card</td><td>Card, String</td><td>CHANGE_VERSION(CARD,VERSION) - Replaces the given card with the data from the specified version (retains traits)</td></tr><tr bgcolor="white"><td></td><td>Card</td><td>List<AnyCardOrStat>, String</td><td>CHANGE_VERSION(CARD,VERSION) - Replaces the given card with the data from the specified version (retains traits)</td></tr><tr bgcolor="white"><td></td><td>Card</td><td>List<Any></td><td>CHANGE_VERSION(VERSION) - Replaces the card with the data from the specified version (retains traits)</td></tr><tr bgcolor="white"><td></td><td>Card</td><td>Card, List<Any></td><td>CHANGE_VERSION(CARD,VERSION) - Replaces the given card with the data from the specified version (retains traits)</td></tr><tr bgcolor="white"><td></td><td>Card</td><td>List<AnyCardOrStat>, List<Any></td><td>CHANGE_VERSION(CARD,VERSION) - Replaces the given card with the data from the specified version (retains traits)</td></tr><tr bgcolor="lightgrey"><td>COPY, DUPLICATE</td><td>List<Card></td><td>AnyCardOrStat, List<AnyCardOrStat></td><td>COPY(CARD,LOCATION) - Duplicates the card and places into the target location and returns the new card in a list (does not copy #unique #nodup cards)</td></tr><tr bgcolor="lightgrey"><td></td><td>List<Card></td><td>List<AnyCardOrStat>, List<Card></td><td>COPY(LIST,LOCATION) - Duplicates the cards in the list and places into the target location and returns the new cards (does not copy #unique #nodup cards)</td></tr><tr bgcolor="white"><td>COPY_ORIGINAL, DUPLICATE_ORIGINAL, CREATE</td><td>List<Card></td><td>AnyCardOrStat, List<AnyCardOrStat></td><td>COPY_ORIGINAL(CARD,LOCATION) - Copies the original version of the card and places into the target location and returns the new card in a list (does not copy #unique #nodup cards)</td></tr><tr bgcolor="white"><td></td><td>List<Card></td><td>List<AnyCardOrStat>, List<Card></td><td>COPY_ORIGINAL(LIST,LOCATION) - Copies the original versions of the cards in the list and places into the target location and returns the new cards (does not copy #unique #nodup cards)</td></tr><tr bgcolor="lightgrey"><td>COUNT</td><td>Numeric</td><td>List<Any></td><td>COUNT(LIST) - returns the number of items in the list</td></tr><tr bgcolor="white"><td>COUNT_TRAIT, COUNTTRAIT</td><td>Numeric</td><td></td><td>COUNTTRAIT - Returns number of occurances of the current trait on card</td></tr><tr bgcolor="white"><td></td><td>Numeric</td><td>String</td><td>COUNTTRAIT(TRAIT) - Returns number of occurances of trait on card</td></tr><tr bgcolor="white"><td></td><td>Numeric</td><td>AnyCardOrStat, String</td><td>COUNTTRAIT(CARD,TRAIT) - Returns number of occurances of trait on card</td></tr><tr bgcolor="white"><td></td><td>Numeric</td><td>List<AnyCardOrStat>, String</td><td>COUNTTRAIT(CARD_LIST,TRAIT) - Returns number of occurances of trait on cards</td></tr><tr bgcolor="lightgrey"><td>DEFEND_EFFECT, DEFENDER_EFFECT</td><td>Void</td><td>OneOrMoreOf<Any></td><td>DEFENDER_EFFECT(...) - Logs the effect of card rules on the DEFENDER</td></tr><tr bgcolor="white"><td>DIFF</td><td>Numeric</td><td>AnyNumeric, AnyNumeric</td><td>DIFF(A,B) - Returns the difference between A and B</td></tr><tr bgcolor="lightgrey"><td>EFFECT, PLAYER_EFFECT</td><td>String</td><td>OneOrMoreOf<Any></td><td>PLAYER_EFFECT(...) - Logs the effect of card rules on the PLAYER</td></tr><tr bgcolor="white"><td>EQ, EQUAL, EQUALS</td><td>Boolean</td><td>Any, Any</td><td>EQ(A,B) - returns TRUE if A == B</td></tr><tr bgcolor="white"><td></td><td>Boolean</td><td>Any, List<Any></td><td>EQ(A,LIST) - returns TRUE if A is in the list</td></tr><tr bgcolor="white"><td></td><td>List<CardStat></td><td>List<CardStat>, Any</td><td>EQ(LIST,A) - returns all cards in the list == A</td></tr><tr bgcolor="white"><td></td><td>List<CardStat></td><td>List<CardStat>, List<Any></td><td>EQ(LIST_A,LIST_B) - returns all cards in LIST_A that matches an item in LIST_B</td></tr><tr bgcolor="white"><td></td><td>List<Card></td><td>List<Card>, Any</td><td>EQ(LIST,A) - returns all cards in the list == A</td></tr><tr bgcolor="white"><td></td><td>List<Card></td><td>List<Card>, List<Any></td><td>EQ(LIST_A,LIST_B) - returns all cards in LIST_A that matches an item in LIST_B</td></tr><tr bgcolor="lightgrey"><td>EVEN</td><td>Boolean</td><td>AnyNumeric</td><td>EVEN(A) - returns TRUE if A is an even number</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>List<AnyNumeric></td><td>EVEN(LIST) - returns all items that are even numbers</td></tr><tr bgcolor="white"><td>EXPIRES</td><td>Numeric</td><td>AnyNumeric</td><td>EXPIRES(N) - Used to cancel a rule after N invocations</td></tr><tr bgcolor="lightgrey"><td>FLIP_TEST, FLIPTEST</td><td>Void</td><td></td><td>FLIP_TEST or FLIP_TEST() - Changes a high test to low and a low to high</td></tr><tr bgcolor="white"><td>GET_BUFF_NUM_PROPERTY, GET_BUFF_NUM_PROP, GETBUFFNUMPROP</td><td>Numeric</td><td>String</td><td>GET_BUFF_NUM_PROPERTY(NAME) - Gets the value of the buff property as a number</td></tr><tr bgcolor="lightgrey"><td>GET_BUFF_PROPERTY, GET_BUFF_PROP, GETBUFFPROP</td><td>String</td><td>String</td><td>GET_BUFF_PROPERTY(NAME) - Gets the value of the buff property</td></tr><tr bgcolor="white"><td>GET_CARD_NUM_PROPERTY, GET_CARD_NUM_PROP, GETCARDNUMPROP</td><td>Numeric</td><td>String</td><td>GET_CARD_NUM_PROPERTY(NAME) - Gets the value of the card property as a number</td></tr><tr bgcolor="white"><td></td><td>Numeric</td><td>String, Numeric</td><td>GET_CARD_NUM_PROPERTY(NAME,DEFAULT) - Gets the value of the card property as a number (returns default if no property exists)</td></tr><tr bgcolor="lightgrey"><td>GET_CARD_PROPERTY, GET_CARD_PROP, GETCARDPROP</td><td>String</td><td>String</td><td>GET_CARD_PROPERTY(NAME) - Gets the value of the card property</td></tr><tr bgcolor="lightgrey"><td></td><td>String</td><td>String, String</td><td>GET_CARD_PROPERTY(NAME,DEFAULT) - Gets the value of the card property (returns default if no property exists)</td></tr><tr bgcolor="white"><td>GET_PLAYER_NUM_PROPERTY, GET_PLAYER_NUM_PROP, GETPLAYERNUMPROP</td><td>Numeric</td><td>String</td><td>GET_PLAYER_NUM_PROPERTY(NAME) - Gets the value of the player property as a number</td></tr><tr bgcolor="white"><td></td><td>Numeric</td><td>String, Numeric</td><td>GET_PLAYER_NUM_PROPERTY(NAME,DEFAULT) - Gets the value of the player property as a number (returns default if no property exists)</td></tr><tr bgcolor="lightgrey"><td>GET_PLAYER_PROPERTY, GET_PLAYER_PROP, GETPLAYERPROP</td><td>String</td><td>String</td><td>GET_PLAYER_PROPERTY(NAME) - Gets the value of the player property</td></tr><tr bgcolor="lightgrey"><td></td><td>String</td><td>String, String</td><td>GET_PLAYER_PROPERTY(NAME,DEFAULT) - Gets the value of the player property (returns default if no property exists)</td></tr><tr bgcolor="white"><td>GT</td><td>Boolean</td><td>AnyNumeric, AnyNumeric</td><td>GT(A,B) - returns TRUE if A > B</td></tr><tr bgcolor="white"><td></td><td>Boolean</td><td>CardStat, AnyNumeric</td><td>GT(A,B) - returns TRUE if A > B</td></tr><tr bgcolor="white"><td></td><td>Boolean</td><td>PlayerStat, AnyNumeric</td><td>LTE(A,B) - returns TRUE if A <= B</td></tr><tr bgcolor="white"><td></td><td>List<CardStat></td><td>List<CardStat>, AnyNumeric</td><td>GT(LIST,A) - returns all items > A</td></tr><tr bgcolor="lightgrey"><td>GTE</td><td>Boolean</td><td>AnyNumeric, AnyNumeric</td><td>GTE(A,B) - returns TRUE if A >= B</td></tr><tr bgcolor="lightgrey"><td></td><td>Boolean</td><td>CardStat, AnyNumeric</td><td>GTE(A,B) - returns TRUE if A >= B</td></tr><tr bgcolor="lightgrey"><td></td><td>Boolean</td><td>PlayerStat, AnyNumeric</td><td>LTE(A,B) - returns TRUE if A <= B</td></tr><tr bgcolor="lightgrey"><td></td><td>List<CardStat></td><td>List<CardStat>, AnyNumeric</td><td>GTE(LIST,A) - returns all items >= A</td></tr><tr bgcolor="white"><td>HAND</td><td>List<Card></td><td></td><td>HAND or HAND() - Returns players hand</td></tr><tr bgcolor="white"><td></td><td>List<Card></td><td>Boolean</td><td>HAND(PLAYER|OPPONENT|ATTACKER|DEFENDER) - Returns players hand if TRUE otherwise opponents hand</td></tr><tr bgcolor="lightgrey"><td>HAS_BUFF, HASBUFF</td><td>Boolean</td><td>String</td><td>HASBUFF(BUFF) - Returns TRUE if the player has the buff, otherwise FALSE</td></tr><tr bgcolor="lightgrey"><td></td><td>Boolean</td><td>Boolean, String</td><td>HASBUFF(PLAYER|OPPONENT|ATTACKER|DEFENDER,BUFF) - Returns TRUE if the player or opponent has the buff, otherwise FALSE</td></tr><tr bgcolor="white"><td>HAS_TAG, HAS_TAGS, HASTAG, HASTAGS</td><td>Boolean</td><td>String</td><td>HASTAG(TRAIT) - Returns TRUE if card has tag</td></tr><tr bgcolor="white"><td></td><td>Boolean</td><td>List<String></td><td>HASTAGS(LIST) - Returns TRUE if card has all tag</td></tr><tr bgcolor="white"><td></td><td>Boolean</td><td>AnyCardOrStat, String</td><td>HASTAG(CARD,TRAIT) - Returns TRUE if card has tag</td></tr><tr bgcolor="white"><td></td><td>Boolean</td><td>AnyCardOrStat, List<String></td><td>HASTAGS(CARD,LIST) - Returns TRUE if card has all tag</td></tr><tr bgcolor="lightgrey"><td>HAS_TRAIT, HAS_TRAITS, HASTRAIT, HASTRAITS</td><td>Boolean</td><td>String</td><td>HAS_TRAIT(TRAIT) - Returns TRUE if card has trait</td></tr><tr bgcolor="lightgrey"><td></td><td>Boolean</td><td>List<String></td><td>HAS_TRAITS(LIST) - Returns TRUE if card has all trait</td></tr><tr bgcolor="lightgrey"><td></td><td>Boolean</td><td>AnyCardOrStat, String</td><td>HAS_TRAIT(CARD,TRAIT) - Returns TRUE if card has trait</td></tr><tr bgcolor="lightgrey"><td></td><td>Boolean</td><td>AnyCardOrStat, List<String></td><td>HAS_TRAITS(CARD,LIST) - Returns TRUE if card has all traits</td></tr><tr bgcolor="white"><td>HEALTH_STAT</td><td>CardStat</td><td></td><td>HEALTH_STAT or HEALTH_STAT() - Returns health stat from card</td></tr><tr bgcolor="white"><td></td><td>CardStat</td><td>Card</td><td>HEALTH_STAT(CARD) - Returns health stat from specified card</td></tr><tr bgcolor="white"><td></td><td>List<CardStat></td><td>List<Card></td><td>HEALTH_STAT(LIST) - Returns health stats from specified card(s)</td></tr><tr bgcolor="lightgrey"><td>IF</td><td>SameAsSecondParam</td><td>Boolean, Either<List<Any>, Any>>, Either<List<Any>, Any>></td><td>IF(COND,A,B) - Returns A if COND is TRUE otherwise returns B</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsSecondParam</td><td>Boolean, Either<List<Any>, Any>></td><td>IF(COND,A) - Returns A if COND is TRUE</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsSecondParam</td><td>List<Any>, Either<List<Any>, Any>>, Either<List<Any>, Any>></td><td>IF(LIST,A,B) - Returns A if LIST is not empty otherwise returns B</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsSecondParam</td><td>List<Any>, Either<List<Any>, Any>></td><td>IF(LIST,A) - Returns A if LIST is not empty</td></tr><tr bgcolor="white"><td>INVADDSUB</td><td>PlayerStat</td><td>AnyNumeric</td><td>INVADDSUB(A) - modifies current stat and returns A-stat if test is high otherwise A+stat</td></tr><tr bgcolor="white"><td></td><td>SameAsFirstParam</td><td>AnyStat, AnyNumeric</td><td>INVADDSUB(A,B) - modifies stat and returns A-B if test is high otherwise A+B</td></tr><tr bgcolor="white"><td></td><td>Numeric</td><td>Numeric, AnyNumeric</td><td>INVADDSUB(A,B) - returns A-B if test is high otherwise A+B</td></tr><tr bgcolor="lightgrey"><td>LIST, _, ANY, DO, ALL, COLLECT, COLLECTION, COMBINE, CONCAT, EACH, BOTH, WHERE, EITHER, THEN, ELSE, EVAL, PROPS, PROPERTIES, PROP, PROPERTY</td><td>List<Any></td><td>OneOrMoreOf<Any></td><td>LIST(A,...) - Combines all parameters into a list.</td></tr><tr bgcolor="white"><td>LOG</td><td>Any</td><td>OneOrMoreOf<Any></td><td>LOG(A,...) - Logs results of all parameters and returns result of last</td></tr><tr bgcolor="lightgrey"><td>LOSES_CLASH, YOULOSE</td><td>Void</td><td></td><td>LOSES_CLASH or LOSES_CLASH() - Changes loser to player</td></tr><tr bgcolor="lightgrey"><td></td><td>Void</td><td>Boolean</td><td>LOSES_CLASH(PLAYER|OPPONENT|ATTACKER|DEFENDER) - If TRUE then changes loser to player, otherwise loser to opponent</td></tr><tr bgcolor="white"><td>LOSSES, LOST, CLASHES_LOST</td><td>Numeric</td><td></td><td>LOSSES or LOSSES() - Returns number of clashes lost by player</td></tr><tr bgcolor="white"><td></td><td>Numeric</td><td>Boolean</td><td>LOSSES(PLAYER|OPPONENT|ATTACKER|DEFENDER) - Returns number of clashes lost by player if TRUE otherwise number of clashes lost by opponent</td></tr><tr bgcolor="lightgrey"><td>LT</td><td>Boolean</td><td>AnyNumeric, AnyNumeric</td><td>LT(A,B) - returns TRUE if A < B</td></tr><tr bgcolor="lightgrey"><td></td><td>Boolean</td><td>CardStat, AnyNumeric</td><td>LT(A,B) - returns TRUE if A < B</td></tr><tr bgcolor="lightgrey"><td></td><td>Boolean</td><td>PlayerStat, AnyNumeric</td><td>LTE(A,B) - returns TRUE if A <= B</td></tr><tr bgcolor="lightgrey"><td></td><td>List<CardStat></td><td>List<CardStat>, AnyNumeric</td><td>LT(LIST,A) - returns all items < A</td></tr><tr bgcolor="white"><td>LTE</td><td>Boolean</td><td>AnyNumeric, AnyNumeric</td><td>LTE(A,B) - returns TRUE if A <= B</td></tr><tr bgcolor="white"><td></td><td>Boolean</td><td>CardStat, AnyNumeric</td><td>LTE(A,B) - returns TRUE if A <= B</td></tr><tr bgcolor="white"><td></td><td>Boolean</td><td>PlayerStat, AnyNumeric</td><td>LTE(A,B) - returns TRUE if A <= B</td></tr><tr bgcolor="white"><td></td><td>List<CardStat></td><td>List<CardStat>, AnyNumeric</td><td>LTE(LIST,A) - returns all items <= A</td></tr><tr bgcolor="lightgrey"><td>MAX</td><td>SameAsFirstParam</td><td>AnyNumeric, AnyNumeric</td><td>MAX(A,B) - returns the largest number</td></tr><tr bgcolor="white"><td>MIN</td><td>SameAsFirstParam</td><td>AnyNumeric, AnyNumeric</td><td>MIN(A,B) - returns the smallest number</td></tr><tr bgcolor="lightgrey"><td>MOVE</td><td>Card</td><td>List<AnyCardOrStat></td><td>MOVE(LOCATION) - Moves the player card to the target location, returns the moved card</td></tr><tr bgcolor="lightgrey"><td></td><td>Card</td><td>AnyCardOrStat, List<AnyCardOrStat></td><td>MOVE(CARD,LOCATION) - Moves the card to the target location, returns the moved card</td></tr><tr bgcolor="lightgrey"><td></td><td>Card</td><td>AnyCardOrStat, AnyCardOrStat</td><td>MOVE(CARD,HAND) - Moves the card to the hand, returns the moved card</td></tr><tr bgcolor="lightgrey"><td></td><td>Card</td><td>List<AnyCardOrStat>, AnyCardOrStat</td><td>MOVE(LIST,LOCATION) - Moves the card to the target location, returns the moved card</td></tr><tr bgcolor="lightgrey"><td></td><td>List<Card></td><td>List<AnyCardOrStat>, List<AnyCardOrStat></td><td>MOVE(LIST,LOCATION) - Moves the cards to the target location, returns the moved cards</td></tr><tr bgcolor="white"><td>MUL, MULTIPLY</td><td>List<String></td><td>String, AnyNumeric</td><td>MUL(TRAIT,B) - returns a list containing B copies of the trait</td></tr><tr bgcolor="white"><td></td><td>List<Card></td><td>Card, AnyNumeric</td><td>MUL(CARD,B) - returns a list containing B copies of the card</td></tr><tr bgcolor="white"><td></td><td>List<Card></td><td>List<Card>, AnyNumeric</td><td>MUL(CARD,B) - returns a list containing B copies of the cards</td></tr><tr bgcolor="white"><td></td><td>Numeric</td><td>AnyNumeric, AnyNumeric</td><td>MUL(A,B) - returns A * B</td></tr><tr bgcolor="white"><td></td><td>SameAsFirstParam</td><td>AnyStat, AnyNumeric</td><td>MUL(A,B) - modifies stat A and returns A * B</td></tr><tr bgcolor="white"><td></td><td>Numeric</td><td>List<AnyNumeric></td><td>MUL(LIST) - returns product of the list of numerics</td></tr><tr bgcolor="lightgrey"><td>NAME_STAT</td><td>CardStat</td><td></td><td>NAME_STAT or NAME_STAT() - Returns name stat from card</td></tr><tr bgcolor="lightgrey"><td></td><td>CardStat</td><td>Card</td><td>NAME_STAT(CARD) - Returns name stat from specified card</td></tr><tr bgcolor="lightgrey"><td></td><td>List<CardStat></td><td>List<Card></td><td>NAME_STAT(LIST) - Returns name stats from specified card(s)</td></tr><tr bgcolor="white"><td>NE, NOTEQUAL, NOTEQUALS</td><td>Boolean</td><td>Any, Any</td><td>NE(A,B) - returns TRUE if A != B</td></tr><tr bgcolor="white"><td></td><td>Boolean</td><td>Any, List<Any></td><td>NE(A,LIST) - returns TRUE if A is not in the list</td></tr><tr bgcolor="white"><td></td><td>List<AnyCardOrStat></td><td>List<AnyCardOrStat>, Any</td><td>NE(LIST,A) - returns all cards in the list != A</td></tr><tr bgcolor="white"><td></td><td>List<AnyCardOrStat></td><td>List<AnyCardOrStat>, List<Any></td><td>NE(LIST_A,LIST_B) - returns all items in LIST_A that are not in LIST_B</td></tr><tr bgcolor="lightgrey"><td>NEWTRAITS, NEWTRAIT, ADDNEWTRAIT, ADDNEWTRAITS</td><td>Card</td><td>String</td><td>NEWTRAITS(TRAIT) - adds trait to card if it doesnt already have it, returns card</td></tr><tr bgcolor="lightgrey"><td></td><td>Card</td><td>List<String></td><td>NEWTRAITS(LIST_TRAIT) - adds traits to card if it doesnt already have it, returns card</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyCardOrStat, String</td><td>NEWTRAITS(CARD,TRAIT) - adds trait to card if it doesnt already have it, returns card</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyCardOrStat, List<String></td><td>NEWTRAITS(CARD,LIST_TRAIT) - adds traits to card if it doesnt already have it, returns card</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>List<AnyCardOrStat>, String</td><td>NEWTRAITS(CARD_LIST,TRAIT) - adds trait to cards if it doesnt already have it, returns cards</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>List<AnyCardOrStat>, List<String></td><td>NEWTRAITS(CARD_LIST,LIST_TRAIT) - adds traits to cards if it doesnt already have it, returns cards</td></tr><tr bgcolor="white"><td>NOT</td><td>Boolean</td><td>Boolean</td><td>NOT(A) - returns FALSE if A is TRUE otherwise FALSE</td></tr><tr bgcolor="lightgrey"><td>NOTAGS, NO_TAGS, WITHOUTTAG, WITHOUT_TAG, WITHOUTTAGS, WITHOUT_TAGS</td><td>SameAsFirstParam</td><td>List<AnyCardOrStat>, String</td><td>WITHOUT_TAG(LIST,T) - returns all cards in the list without the tag T</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>List<Any>, List<String></td><td>WITHOUT_TAGS(LIST_A,LIST_T) - returns all cards in LIST_A that have none of the tags in LIST_T</td></tr><tr bgcolor="white"><td>NOTRAITS, NO_TRAITS, WITHOUTTRAIT, WITHOUT_TRAIT, WITHOUTTRAITS, WITHOUT_TRAITS</td><td>SameAsFirstParam</td><td>List<AnyCardOrStat>, String</td><td>WITHOUT_TRAIT(LIST,T) - returns all cards in the list without the trait T</td></tr><tr bgcolor="white"><td></td><td>SameAsFirstParam</td><td>List<Any>, List<String></td><td>WITHOUT_TRAITS(LIST_A,LIST_T) - returns all cards in LIST_A that have none of the traits in LIST_T</td></tr><tr bgcolor="lightgrey"><td>NUM, NUMBER, NUMERIC, TONUMBER, ASNUMBER</td><td>Numeric</td><td>AnyNumeric</td><td>NUM(A) - return the number not associated with a card</td></tr><tr bgcolor="white"><td>ODD</td><td>Boolean</td><td>AnyNumeric</td><td>ODD(A) - returns TRUE if A is an odd number</td></tr><tr bgcolor="white"><td></td><td>SameAsFirstParam</td><td>List<AnyNumeric></td><td>ODD(LIST) - returns all items that are odd numbers</td></tr><tr bgcolor="lightgrey"><td>ONE_OF, ONEOF</td><td>SameAsFirstParam</td><td>OneOrMoreOf<Any></td><td>ONE_OF(A,...) - returns one of the parameters</td></tr><tr bgcolor="white"><td>OPP_EFFECT, OPPONENT_EFFECT</td><td>Void</td><td>OneOrMoreOf<Any></td><td>OPPONENT_EFFECT(...) - Logs the effect of card rules on the OPPONENT</td></tr><tr bgcolor="lightgrey"><td>OR</td><td>Boolean</td><td>Boolean, OneOrMoreOfTheSame<Boolean></td><td>OR(A,B,...) - returns TRUE if any parameters are TRUE</td></tr><tr bgcolor="white"><td>PLAYED, PLAYED_CARDS, PLAYED_CARDS_THIS_GAME</td><td>List<Card></td><td></td><td>PLAYED or PLAYED() - Returns list of all cards played this game</td></tr><tr bgcolor="white"><td></td><td>List<Card></td><td>Boolean</td><td>PLAYED(PLAYER|OPPONENT|ATTACKER|DEFENDER) - Returns list of cards played this game by player</td></tr><tr bgcolor="lightgrey"><td>POWER_STAT</td><td>CardStat</td><td></td><td>POWER_STAT or POWER_STAT() - Returns power stat from card</td></tr><tr bgcolor="lightgrey"><td></td><td>CardStat</td><td>Card</td><td>POWER_STAT(CARD) - Returns power stat from specified card</td></tr><tr bgcolor="lightgrey"><td></td><td>List<CardStat></td><td>List<Card></td><td>POWER_STAT(LIST) - Returns power stats from specified card(s)</td></tr><tr bgcolor="white"><td>PREV_LOSER, PREV_CLASH_LOST, LAST_CLASH_LOST, LOST_PREV_CLASH, LOST_LAST_CLASH</td><td>Boolean</td><td></td><td>PREV_LOSER or PREV_LOSER() - Returns whether the player was the loser of the previous clash</td></tr><tr bgcolor="white"><td></td><td>Boolean</td><td>Boolean</td><td>PREV_LOSER(PLAYER|OPPONENT|ATTACKER|DEFENDER) - If TRUE then returns whether the player was the loser of the previous clash, otherwise whether the oppponent lost</td></tr><tr bgcolor="lightgrey"><td>PREV_WINNER, PREV_CLASH_WINNER, LAST_CLASH_WINNER, WON_PREV_CLASH, WON_LAST_CLASH</td><td>Boolean</td><td></td><td>PREV_WINNER or PREV_WINNER() - Returns whether the player was the winner of the previous clash</td></tr><tr bgcolor="lightgrey"><td></td><td>Boolean</td><td>Boolean</td><td>PREV_WINNER(PLAYER|OPPONENT|ATTACKER|DEFENDER) - If TRUE then returns whether the player was the winner of the previous clash, otherwise whether the oppponent won</td></tr><tr bgcolor="white"><td>PRINT</td><td>String</td><td>OneOrMoreOf<Any></td><td>PRINT(A,...) - Prints results of all parameters and returns string</td></tr><tr bgcolor="lightgrey"><td>RANDOM, RANDCARD, RAND, RANDNUM</td><td>SameAsFirstParam</td><td>List<Any>, AnyNumeric</td><td>RANDOM(LIST,N) - Returns upto N random item(s) from a list</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>List<Any></td><td>RANDOM(LIST) - Returns upto 1 random item from a list</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyNumeric, AnyNumeric</td><td>RANDNUM(A,B) - returns a number betwen A and B (inclusive)</td></tr><tr bgcolor="white"><td>REMOVE_BUFF, REMOVEBUFF</td><td>Void</td><td></td><td>REMOVE_BUFF or REMOVE_BUFF() - Removes this buff from the player</td></tr><tr bgcolor="lightgrey"><td>REMOVEALLTRAITS</td><td>Card</td><td>String</td><td>REMOVEALLTRAITS(TRAIT) - remove all ocurrances of trait from card, returns card</td></tr><tr bgcolor="lightgrey"><td></td><td>Card</td><td>List<String></td><td>REMOVEALLTRAITS(LIST_TRAIT) - remove all ocurrances of traits from card, returns card</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyCardOrStat, String</td><td>REMOVEALLTRAITS(CARD,TRAIT) - remove all ocurrances of trait  from card, returns card</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyCardOrStat, List<String></td><td>REMOVEALLTRAITS(CARD,LIST_TRAIT) -remove all ocurrances of traits from card, returns card</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>List<AnyCardOrStat>, String</td><td>REMOVEALLTRAITS(CARD_LIST,TRAIT) - remove all ocurrances of trait from cards, returns cards</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>List<AnyCardOrStat>, List<String></td><td>REMOVEALLTRAITS(CARD_LIST,LIST_TRAIT) - remove all ocurrances of traits from cards, returns cards</td></tr><tr bgcolor="white"><td>REMOVETAG, REMOVETAGS</td><td>Card</td><td>String</td><td>REMOVETAG(TAG) - remove a tag from card, returns card</td></tr><tr bgcolor="white"><td></td><td>Card</td><td>List<String></td><td>REMOVETAGS(TAGS) - remove all tags from card, returns card</td></tr><tr bgcolor="white"><td></td><td>SameAsFirstParam</td><td>AnyCardOrStat, String</td><td>REMOVETAG(CARD,TAG) - remove a tag from card, returns card</td></tr><tr bgcolor="white"><td></td><td>SameAsFirstParam</td><td>AnyCardOrStat, List<String></td><td>REMOVETAGS(CARD,TAGS) -remove all tags from card, returns card</td></tr><tr bgcolor="white"><td></td><td>SameAsFirstParam</td><td>List<AnyCardOrStat>, String</td><td>REMOVETAG(CARD_LIST,TAG) - remove a tag from cards, returns cards</td></tr><tr bgcolor="white"><td></td><td>SameAsFirstParam</td><td>List<AnyCardOrStat>, List<String></td><td>REMOVETAGS(CARD_LIST,TAGS) - remove all tags from cards, returns cards</td></tr><tr bgcolor="lightgrey"><td>REMOVETRAITS, REMOVETRAIT</td><td>Card</td><td>String</td><td>REMOVETRAIT(TRAIT) - remove a trait from card, returns card</td></tr><tr bgcolor="lightgrey"><td></td><td>Card</td><td>List<String></td><td>REMOVETRAITS(LIST_TRAIT) - remove a traits from card, returns card</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyCardOrStat, String</td><td>REMOVETRAIT(CARD,TRAIT) - remove a trait from card, returns card</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyCardOrStat, List<String></td><td>REMOVETRAITS(CARD,LIST_TRAIT) -remove a traits from card, returns card</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>List<AnyCardOrStat>, String</td><td>REMOVETRAIT(CARD_LIST,TRAIT) - remove a trait from cards, returns cards</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>List<AnyCardOrStat>, List<String></td><td>REMOVETRAITS(CARD_LIST,LIST_TRAIT) - remove a traits from cards, returns cards</td></tr><tr bgcolor="white"><td>REPLACE_CARD, REPLACECARD</td><td>Card</td><td>Card</td><td>REPLACE_CARD(SOURCE_CARD) - Replaces the card with the data from the source card (retains traits)</td></tr><tr bgcolor="white"><td></td><td>Card</td><td>List<Any></td><td>REPLACE_CARD(SOURCE_CARD) - Replaces the card with the data from the source card (retains traits)</td></tr><tr bgcolor="white"><td></td><td>Card</td><td>Card, Card</td><td>REPLACE_CARD(CARD,SOURCE_CARD) - Replaces the given card with the data from the source card (retains traits)</td></tr><tr bgcolor="white"><td></td><td>Card</td><td>Card, List<Any></td><td>REPLACE_CARD(CARD,SOURCE_CARD) - Replaces the given card with the data from the source card (retains traits)</td></tr><tr bgcolor="white"><td></td><td>Card</td><td>List<Any>, Card</td><td>REPLACE_CARD(CARD,SOURCE_CARD) - Replaces the given card with the data from the source card (retains traits)</td></tr><tr bgcolor="white"><td></td><td>Card</td><td>List<Any>, List<Any></td><td>REPLACE_CARD(CARD,SOURCE_CARD) - Replaces the given card with the data from the source card (retains traits)</td></tr><tr bgcolor="lightgrey"><td>RESERVES</td><td>List<Card></td><td></td><td>RESERVES or RESERVES() - Returns players reserves</td></tr><tr bgcolor="lightgrey"><td></td><td>List<Card></td><td>Boolean</td><td>RESERVES(PLAYER|OPPONENT|ATTACKER|DEFENDER) - Returns players reserves if TRUE otherwise opponents reserves</td></tr><tr bgcolor="white"><td>RESET_CARD, RESETCARD</td><td>Card</td><td></td><td>RESET_CARD or RESET_CARD() - Resets the card data [potentially re-randomizing the stats] (retains traits)</td></tr><tr bgcolor="white"><td></td><td>Card</td><td>Card</td><td>RESET_CARD(CARD) - Resets the card data [potentially re-randomizing the stats] (retains traits)</td></tr><tr bgcolor="lightgrey"><td>REVEAL</td><td>Boolean</td><td>AnyCardOrStat</td><td>REVEAL(CARD) - Reveals the card</td></tr><tr bgcolor="lightgrey"><td></td><td>Boolean</td><td>List<AnyCardOrStat></td><td>REVEAL(LIST) - Reveals a random card from the list (prioritizes already revealed cards first).  Returns FALSE if the list was empty otherwise TRUE</td></tr><tr bgcolor="lightgrey"><td></td><td>Boolean</td><td>List<AnyCardOrStat>, Numeric</td><td>REVEAL(LIST,N) - Reveals N random cards from the list (prioritizes already revealed cards first).  Returns FALSE if the list has less than N cards otherwise TRUE</td></tr><tr bgcolor="white"><td>SET, SET_STAT, SET_CARD_STAT, CHANGE_CARD_STAT</td><td>CardStat</td><td>CardStat, CardStat</td><td>SET(STAT,A) - Sets stat to A and returns card stat (change is scoped depending on phase to CA:game, CMA:match)</td></tr><tr bgcolor="white"><td></td><td>CardStat</td><td>CardStat, String</td><td>SET(STAT,A) - Sets stat to A and returns card stat (change is scoped depending on phase to CA:game, CMA:match)</td></tr><tr bgcolor="white"><td></td><td>CardStat</td><td>CardStat, Numeric</td><td>SET(STAT,A) - Sets stat to A and returns card stat (change is scoped depending on phase to CA:game, CMA:match)</td></tr><tr bgcolor="white"><td></td><td>List<CardStat></td><td>List<CardStat>, CardStat</td><td>SET(LIST,A) - Sets each cards stat to A and returns list (change is scoped depending on phase to CA:game, CMA:match)</td></tr><tr bgcolor="lightgrey"><td>SET_BUFF_PROPERTY, SET_BUFF_PROP, SETBUFFPROP</td><td>Void</td><td>String, Any</td><td>SET_BUFF_PROPERTY(NAME,VALUE) - Sets the buff property to the value</td></tr><tr bgcolor="white"><td>SET_CARD_PROPERTY, SET_CARD_PROP, SETCARDPROP</td><td>Void</td><td>String, Any</td><td>SET_CARD_PROPERTY(NAME,VALUE) - Sets the card property to the value</td></tr><tr bgcolor="lightgrey"><td>SET_PLAYER_PROPERTY, SET_PLAYER_PROP, SETPLAYERPROP</td><td>Void</td><td>String, Any</td><td>SET_PLAYER_PROPERTY(NAME,VALUE) - Sets the card property to the value</td></tr><tr bgcolor="white"><td>SPEED_STAT</td><td>CardStat</td><td></td><td>SPEED_STAT or SPEED_STAT() - Returns speed stat from card</td></tr><tr bgcolor="white"><td></td><td>CardStat</td><td>Card</td><td>SPEED_STAT(CARD) - Returns speed stat from specified card</td></tr><tr bgcolor="white"><td></td><td>List<CardStat></td><td>List<Card></td><td>SPEED_STAT(LIST) - Returns speed stats from specified card(s)</td></tr><tr bgcolor="lightgrey"><td>STAT</td><td>PlayerStat</td><td></td><td>STAT or STAT() - Returns players stat</td></tr><tr bgcolor="lightgrey"><td></td><td>PlayerStat</td><td>Boolean</td><td>STAT(PLAYER|OPPONENT|ATTACKER|DEFENDER) - Returns players stat if TRUE otherwise opponents stat</td></tr><tr bgcolor="white"><td>STRING, STR, RULE</td><td>String</td><td>String</td><td>STRING(A) - Creates a string i.e. does not resolve parameters</td></tr><tr bgcolor="lightgrey"><td>SUB, SUBTRACT</td><td>PlayerStat</td><td>AnyNumeric</td><td>SUB(A) - modifies current stat and returns A-stat</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyStat, AnyNumeric</td><td>SUB(A,B) - modifies stat A and returns A-B</td></tr><tr bgcolor="lightgrey"><td></td><td>Numeric</td><td>Numeric, AnyNumeric</td><td>SUB(A,B) - returns A-B</td></tr><tr bgcolor="white"><td>TIES_CLASH, BOTHTIE</td><td>Void</td><td></td><td>TIES_CLASH or TIES_CLASH() - Changes clash result to tie</td></tr><tr bgcolor="lightgrey"><td>TRAITS</td><td>List<String></td><td></td><td>TRAITS or TRAITS() - Returns unique traits from card</td></tr><tr bgcolor="lightgrey"><td></td><td>List<String></td><td>CardStat</td><td>TRAITS(STAT) - Returns unique traits from stat</td></tr><tr bgcolor="lightgrey"><td></td><td>List<String></td><td>Card</td><td>TRAITS(CARD) - Returns unique traits from specified card</td></tr><tr bgcolor="lightgrey"><td></td><td>List<String></td><td>List<CardStat></td><td>TRAITS(LIST) - Returns unqiue traits from specified stat(s)</td></tr><tr bgcolor="lightgrey"><td></td><td>List<String></td><td>List<Card></td><td>TRAITS(LIST) - Returns unqiue traits from specified card(s)</td></tr><tr bgcolor="white"><td>TRAITS_STAT</td><td>CardStat</td><td></td><td>TRAITS_STAT or TRAITS_STAT() - Returns traits stat from card</td></tr><tr bgcolor="white"><td></td><td>CardStat</td><td>Card</td><td>TRAITS_STAT(CARD) - Returns traits stat from specified card</td></tr><tr bgcolor="white"><td></td><td>List<CardStat></td><td>List<Card></td><td>TRAITS_STAT(LIST) - Returns traits stat from specified card(s)</td></tr><tr bgcolor="lightgrey"><td>TREASURE</td><td>List<Card></td><td></td><td>TREASURE or TREASURE() - Returns players treasure</td></tr><tr bgcolor="lightgrey"><td></td><td>List<Card></td><td>Boolean</td><td>TREASURE(PLAYER|OPPONENT|ATTACKER|DEFENDER) - Returns players treasure if TRUE otherwise opponents treasure</td></tr><tr bgcolor="white"><td>TYPE_STAT</td><td>CardStat</td><td></td><td>TYPE_STAT or TYPE_STAT() - Returns type stat from card</td></tr><tr bgcolor="white"><td></td><td>CardStat</td><td>Card</td><td>TYPE_STAT(CARD) - Returns type stat from specified card</td></tr><tr bgcolor="white"><td></td><td>List<CardStat></td><td>List<Card></td><td>TYPE_STAT(LIST) - Returns type stats from specified card(s)</td></tr><tr bgcolor="lightgrey"><td>USE</td><td>PlayerStat</td><td>AnyStat</td><td>USE(STAT) - Sets and returns players stat</td></tr><tr bgcolor="lightgrey"><td></td><td>PlayerStat</td><td>Numeric</td><td>USE(STAT) - Sets and returns players stat</td></tr><tr bgcolor="lightgrey"><td></td><td>PlayerStat</td><td>Boolean, AnyStat</td><td>USE(PLAYER|OPPONENT|ATTACKER|DEFENDER,STAT) - Sets and returns players stat if TRUE otherwise opponents stat</td></tr><tr bgcolor="lightgrey"><td></td><td>PlayerStat</td><td>Boolean, Numeric</td><td>USE(PLAYER|OPPONENT|ATTACKER|DEFENDER,STAT) - Sets and returns players stat if TRUE otherwise opponents stat</td></tr><tr bgcolor="white"><td>VP_STAT, VICTORY_POINT_STAT, VPS, VICTORY_POINTS</td><td>CardStat</td><td></td><td>VP_STAT or VP_STAT() - Returns victory points from card</td></tr><tr bgcolor="white"><td></td><td>CardStat</td><td>Card</td><td>VP_STAT(CARD) - Returns victory points from specified card</td></tr><tr bgcolor="white"><td></td><td>List<CardStat></td><td>List<Card></td><td>VP_STAT(LIST) - Returns victory points from specified card(s)</td></tr><tr bgcolor="lightgrey"><td>WINS, WON, CLASHES_WON</td><td>Numeric</td><td></td><td>WINS or WINS() - Returns number of clashes won by player</td></tr><tr bgcolor="lightgrey"><td></td><td>Numeric</td><td>Boolean</td><td>WINS(PLAYER|OPPONENT|ATTACKER|DEFENDER) - Returns number of clashes won by player if TRUE otherwise number of clashes won by opponent</td></tr><tr bgcolor="white"><td>WINS_CLASH, YOUWIN</td><td>Void</td><td></td><td>WINS_CLASH or WINS_CLASH() - Changes winner to player</td></tr><tr bgcolor="white"><td></td><td>Void</td><td>Boolean</td><td>WINS_CLASH(PLAYER|OPPONENT|ATTACKER|DEFENDER) - If TRUE then changes winner to player, otherwise winner to opponent</td></tr><tr bgcolor="lightgrey"><td>WORST</td><td>SameAsFirstParam</td><td>AnyStat, AnyStat</td><td>WORST(A,B) - Returns the worst of stat A and stat B</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyStat, String</td><td>WORST(A,B) - Returns the worst of stat A and stat B</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyStat, Numeric</td><td>WORST(A,B) - Returns the worst of stat A and stat B</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyStat, List<AnyStat></td><td>WORST(A,LIST) - Returns the worst of stat A and any stat in the list</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyStat, List<String></td><td>WORST(A,LIST) - Returns the worst of stat A and any stat in the list</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyStat, List<Numeric></td><td>WORST(A,LIST) - Returns the worst of stat A and any stat in the list</td></tr><tr bgcolor="lightgrey"><td></td><td>SameAsFirstParam</td><td>AnyStat, List<Any></td><td>BEST(A,LIST) - Returns the better of stat A and any stat in the list</td></tr><tr bgcolor="white"><td>XOR</td><td>Boolean</td><td>Boolean, OneOrMoreOfTheSame<Boolean></td><td>XOR(A,B,...) - returns TRUE if only one of the parameters are TRUE</td></tr></table>

    <h1>Macros</h1>
    <table><tr><th>Name</th><th>Parameters</th><th>Macro</th><th>Description</th><th>Example</th></tr><tr bgcolor="lightgrey"><td>5050</td><td></td><td>CHANCE(1,2)</td><td>Returns TRUE 50 of the time</td><td>"IF(5050,ADD(1),SUB(1))"</td></tr><tr bgcolor="white"><td>CHANCE</td><td>o, r</td><td>GT(RANDNUM(0,{r}),SUB({r},{o}))</td><td>Returns TRUE 'o' out of 'r' times, e.g 1 out of 2 aka 50%</td><td>"IF(CHANCE(1,2),ADD(1),SUB(1))"</td></tr><tr bgcolor="lightgrey"><td>DO_5050</td><td>a, b</td><td>IF(5050,{a},{b})</td><td>Perform A 50% of the time otherwise B</td><td>"DO_5050(ADD(1),SUB(1))"</td></tr><tr bgcolor="white"><td>DOTWICE</td><td>rule</td><td>THEN({rule},{rule})</td><td>Perform the rule two times</td><td></td></tr><tr bgcolor="lightgrey"><td>DOUBLE</td><td>a</td><td>MUL(2,{a})</td><td>Double a number</td><td>ADDSUB(DOUBLE(NUMMAGICUSERS(OPP_HAND)))</td></tr><tr bgcolor="white"><td>DVEG1</td><td>a, b</td><td>ADD({a},{b})</td><td>no parameters required</td><td>"DVEG1,DVEG1(),DVEG1(1),DVEG1(1,2)"</td></tr><tr bgcolor="lightgrey"><td>DVEG2</td><td>a, b</td><td>ADD({a},{b})</td><td>optional second parameter</td><td>"DVEG2(1),DVEG2(1,2)"</td></tr><tr bgcolor="white"><td>GETMAGICUSERS</td><td>a</td><td>EQ(TYPE_STAT({a}),MAGICUSER)</td><td>Get magic users</td><td>"ADDSUB(MUL(2,COUNT(GETMAGICUSERS(OPP_HAND))))"</td></tr><tr bgcolor="lightgrey"><td>MAGICUSER</td><td></td><td>LIST(WIZARD,FAMILIAR,AVATAR)</td><td>List of magic user types</td><td>"ADDSUB(MUL(2,COUNT(EQ(TYPE_STAT(OPP_HAND),MAGICUSER))))"</td></tr><tr bgcolor="white"><td>NUMMAGICUSERS</td><td>a</td><td>COUNT(GETMAGICUSERS({a}))</td><td>Get number of magic users</td><td>ADDSUB(DOUBLE(NUMMAGICUSERS(OPP_HAND)))</td></tr><tr bgcolor="lightgrey"><td>ONE</td><td>list</td><td>RANDOM({list})</td><td>Randomly picks one item from the list</td><td>ONE(@GOLD(OPPONENT_RESERVES))</td></tr><tr bgcolor="white"><td>STATDIFF</td><td></td><td>DIFF(PLAYER_STAT,OPPONENT_STAT)</td><td>Difference between the player stats</td><td>"GT(STATDIFF,3)"</td></tr></table>

    <h1>Specific Constants</h1>
    <table><tr><th>Name(s)</th><th>Type</th><th>Description</th></tr><tr bgcolor="lightgrey"><td>OPPONENT, OPP</td><td>Boolean</td><td>The opponent</td></tr><tr bgcolor="white"><td>PLAYER</td><td>Boolean</td><td>The player</td></tr></table>

    <h1>Generic Constants</h1><ul>
        <li>-20, -19, ..., -1, 0, 1, ... 19, 20</li>
        <li>TRUE, FALSE</li>
        <li>An uppercase constant for all types in the card file, e.g. AVATAR, ... WIZARD</li>
    </ul>

    <h1>Card file syntax (columns)</h1><ul>
        <li>CARD TIMING: One of GB, BC, CC, CT, CH, CMA, CA, MS, MR, RC, GE</li>
        <li>CARD SOURCE: One of "", "reserves", "hand", "hand:played"</li>
        <li>CARD RULES: expression(s) and/or comment (// the double forward slash symbol starts a comment)</li>
    </ul>

    <h1>Clash phases</h1>
    Card play in a clash is resolved in the following order (phases):
    <ul>
        <li>GB - Before first Clash/li>
        <li>BC - Before Clash: e.g. change attacker</li>
        <li>CC - Change Cards: e.g. change played cards</li>
        <li>CT - Change Test: e.g. flip high/low</li>
        <li>CH - Change Hand: e.g. move cards to and from hand or reserves</li>
        <li>CMA - Change Card Attribute for Match: e.g. change original power stat regardless of test (can stack effects)</li>
        <li>CA - Change Card Attribute for Game: e.g. change original power stat regardless of test (can stack effects)</li>
        <li>MS - Modify Stat: e.g. modify the current active stat</li>
        <li>MR - Modify Result: e.g. change tie to win</li>
        <li>RC - Resolve Clash: e.g. reward winner</li>
        <li>Ge - After final Clash/li>
    </ul>

    Within each phase, the rules on cards are resolved in the following order where the Attacker calls the clash stat/test:
    <ul>
        <li>Attacker Player Effects (Cards add player effects using the ADDRULE function)</li>
        <li>Attacker Reserve Effects (Cards with a source of 'reserves' are revealed from the hand)</li>
        <li>Attacker Hand Effects (Cards with a source of 'hand' are revealed from the hand)</li>
        <li>Attacker Card Effects (Cards with a source of 'played' or '' when played)</li>
        <li>Defender Player Effects</li>
        <li>Defender Reserve Effects</li>
        <li>Defender Hand Effects</li>
        <li>Defender Card Effects</li>
    </ul>
    <h1>In Game Console Commands</h1>
    <table>
        <tr>
            <th>Command</th>
            <th>Parameters</th>
            <th>Description</th>
        </tr>
        <tr>
            <td>FindCard</td>
            <td>cardNumberOrName</td>
            <td>Find the location of a specific card</td>
        </tr>
        <tr>
            <td>ListCards</td>
            <td>location</td>
            <td>List all cards in the location along with count of number of instances</td>
        </tr>
            <td>ListCardLocations</td>
            <td></td>
            <td>List all card locations and the number of cards in the location</td>
        </tr>
        <tr>
            <td>MoveCard</td>
            <td>cardNumberOrName, location</td>
            <td>Move a card from anywhere to the destination location (e.g. @Deck)</td>
        </tr>
        <tr>
            <td>PrintCard</td>
            <td>cardNumberOrName</td>
            <td>Print the details of the card (if there are multiple then it prints the first)</td>        
        </tr>
        </tr>
            <td>SetCardValue</td>
            <td>cardNumberOrName, stat, value</td>
            <td>stats: type,speed,power,armor,health,vps,tags,traits,rules,sources,timing,weighting</td>
        </tr>
    </table>

    <h1>In Game Keyboard Shortcuts</h1>
    
    <table>
        <tr>
            <th>Key</th>
            <th>Description</th>
        </tr>
        <tr>
            <td>B</td>
            <td>cycle through backgrounds</td>
        </tr>
        <tr>
            <td>Left Shift</td>
            <td>display actual rules instead of 'english' rules</td>
        </tr>
    </table>

    <script>
        function checkNestedParentheses(input) {
            const stack = [];
            let i = 0;
            for (let char of input) {
                i ++;
                if (char === '(') {
                    stack.push(char);
                } else if (char === ')') {
                    if (stack.length === 0) {
                        return i; // Unmatched closing parenthesis
                    }
                    stack.pop();
                }
            }
            return (stack.length === 0) ? -1 : i; // True if all parentheses are matched
        }

        function checkSyntax() {
            const inputText = document.getElementById('inputText').value;
            const resultDiv = document.getElementById('result');

            let errorAt = checkNestedParentheses(inputText);
            if (errorAt !== -1) {
                let errorTextLeft = inputText.substring(0, errorAt - 1);
                let errorTextRight = inputText.substring(errorAt - 1);
                resultDiv.textContent = 'Syntax error: Unmatched parentheses \"' + errorTextLeft + "^" + errorTextRight + "\"";
                resultDiv.style.color = 'red';
                return;
            }

            try {
                //new Function(inputText);
                resultDiv.textContent = 'Syntax is correct!';
                resultDiv.style.color = 'green';
            } catch (e) {
                resultDiv.textContent = 'Syntax error: ' + e.message;
                resultDiv.style.color = 'red';
            }
        }
    </script>
</body>
</html>
